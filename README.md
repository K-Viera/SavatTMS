# SavatTMS Project

## Overview
SavatTMS is a Transportation Management System (TMS) designed to streamline the operations of shipping and logistics. The system allows for efficient management of shipments, including tracking, scheduling, and reporting functionalities.

## Project Structure

- **TMSApi/**: The main project directory containing the ASP.NET Core Web API application.
  - **Controllers/**: Contains the API controllers.
  - **DTOs/**: Data Transfer Objects used for data exchange between the client and server.
  - **Models/**: Entity models representing the database tables.
  - **Services/**: Business logic services.
- **TMSTests/**: Contains unit tests for the TMSApi project.
  - **ShipmentControllerTests.cs**: Tests for the Shipment controller.
  - **ShipmentServiceTest.cs**: Tests for the Shipment service.
- **Scripts/**: SQL scripts for database creation and initial data population.

## API Endpoints

Below are the available endpoints in the [SavatTMS API](https://github.com/K-Viera/SavatTMS/tree/main/TMSApi):

### Authentication
- `POST /login`: Authenticate a user and return a JWT token.

### Shipments
All shipment-related use "Authorization" token in the header. The token is generated by the login endpoint and should be included in the header.
- `GET /Shipment`: Retrieve all shipments.
- `POST /Shipment`: Create a new shipment.
- `GET /Shipment/{trackingNumber}`: Retrieve a shipment by its tracking number.
- `PUT /Shipment/{trackingNumber}`: Update a shipment by its tracking number.
- `DELETE /Shipment/{trackingNumber}`: Delete a shipment by its tracking number.
- `GET /Shipment/search`: Search for shipments based on optional query parameters.

You can refer to the Swagger documentation `/swagger/index.html` when you run the application for more details on the available endpoints.

### Postman Collection
You can also refer to the public Postman collection for the API endpoints [here](https://www.postman.com/warped-astronaut-540935/workspace/savattms/overview).

## Testing

The [`TMSTests`]([TMSTests](https://github.com/K-Viera/SavatTMS/tree/main/TMSTests)) solution. These tests ensure that the application behaves as expected under various conditions.

### Shipment Service Tests

The [`ShipmentServiceTests`](https://github.com/K-Viera/SavatTMS/blob/main/TMSTests/ShipmentServiceTest.cs) class tests the business logic layer of the application. It verifies that shipments can be added correctly and handles errors as expected. For instance, the [`AddShipmentAsync_ShouldAddShipment_WhenShipmentIsValid`](https://github.com/K-Viera/SavatTMS/blob/main/TMSTests/ShipmentServiceTest.cs#L34) test ensures that a valid shipment is added successfully.

### Shipment Controller Tests

The [`ShipmentControllerTests`](https://github.com/K-Viera/SavatTMS/blob/main/TMSTests/ShipmentControllerTests.cs) class focuses on testing the API endpoints, ensuring that the correct HTTP responses are returned for different scenarios. For example, the [`Add_ReturnsCreatedAtAction_WhenShipmentIsAddedSuccessfully`](https://github.com/K-Viera/SavatTMS/blob/main/TMSTests/ShipmentControllerTests.cs#L78) test checks that a `201 Created` response is returned when a new shipment is added successfully.

### Running the Tests

To run the tests, navigate to the root directory of the solution and use the following command:

```bash
dotnet test
```

This command will execute all tests within the solution and provide a summary of which tests passed and which failed, allowing developers to ensure the application's functionality is working as expected before deployment.

### Test Results

After running the tests, you will receive a detailed report of the test outcomes. It's crucial to review these results to identify any failures and address them promptly to maintain the quality and reliability of the application behaves as expected under various conditions.

## Start the Application

### Prerequisites
- .NET 5.0 SDK or later
- Microsoft SQL Server
- Visual Studio 2019 or later (for development)

### Installation

1. Clone the repository to your local machine:
   ```bash
   git clone https://github.com/your-username/SavatTMS.git
   ```

2. Navigate to the project directory:
   ```bash
   cd SavatTMS
   ```

3. Restore the .NET packages:
   ```bash
   dotnet restore
   ```

4. Set up the database by running the SQL scripts located in the `Scripts` directory. First, create the database and tables:
   ```sql
   -- Run the contents of CreateDatabaseAndTables.sql
   ```

5. Populate the database with initial data:
   ```sql
   -- Run the contents of PopulateTablesScript.sql
   ```

6. Update the `appsettings.json` file in the `TMSApi` directory with your database connection string.

### Running the Application

1. Navigate to the `TMSApi` directory:
   ```bash
   cd TMSApi
   ```

2. Run the application:
   ```bash
   dotnet run
   ```

   The API will start, and you can access it through [http://localhost:5000](http://localhost:5000) by default.
